<script>
  //-- Imports--
  import { goto } from "$app/navigation";
  import { flip } from 'svelte/animate';
  import { fade, fly } from 'svelte/transition';
  //-- Imports--

  let vector = "assets/image/vector.png";
  let logo = "assets/image/logo.png";
  let inputValue = "";
  let active = false;
  let error = '';
  let testing = false;
  // let message = '';

  function cancelInactive() {
    if (inputValue) {
      active = true;
    } else {
      active = false;
    }
  };
//-- Post Phone Number--
  async function postPhone() {
      try {
          const res = await fetch(`${import.meta.env.VITE_BASEURL}/v1/phone`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              phone : inputValue,
            }),
          });
          testing = true;
          // const json = await res.json();
          // message = json;
          if (res.ok) {
            return {
              status : 200,
            }
          }else {
            if( res.status === 429)
              error = "شماره‌ی شما قبلا ثبت شده است";
          }
      }catch (err){
        error = err ;
      }
  }

  //-- Post Phone Number--
</script>

<div class="bg-center">
  <div class="col-12 d-flex justify-center items-center flex-wrap">
    <div class="col-lg-6 w-full h-full p-5">
      <svg
        class="mb-32"
        width="133"
        height="57"
        viewBox="0 0 133 57"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <rect
          x="34.2129"
          y="29.6621"
          width="10.2824"
          height="20.7626"
          rx="1.97739"
          fill="url(#paint0_linear_830_1007)"
        />
        <g filter="url(#filter0_d_830_1007)">
          <path
            d="M43.3653 29.682C44.0269 29.682 44.5668 30.2188 44.5287 30.8793C44.3158 34.5688 43.1221 38.1428 41.0609 41.2276C38.7774 44.6451 35.5317 47.3088 31.7344 48.8817C27.937 50.4546 23.7585 50.8661 19.7273 50.0643C15.6961 49.2624 11.9931 47.2832 9.08679 44.3768C6.18043 41.4704 4.20118 37.7675 3.39931 33.7363C2.59745 29.705 3.009 25.5266 4.5819 21.7292C6.15481 17.9319 8.81844 14.6862 12.236 12.4027C15.3208 10.3415 18.8948 9.14778 22.5843 8.9349C23.2448 8.89679 23.7816 9.43672 23.7816 10.0983L23.7816 28.4841C23.7816 29.1457 24.3179 29.682 24.9795 29.682H43.3653Z"
            fill="url(#paint1_radial_830_1007)"
          />
        </g>
        <path
          d="M60.1804 19.7385C61.6679 19.7385 62.9755 20.0384 64.1032 20.6382C65.2308 21.214 66.1185 21.9698 66.7663 22.9055V20.0624H71.8407V40.144C71.8407 41.9914 71.4688 43.6348 70.725 45.0744C69.9813 46.5379 68.8656 47.6895 67.3781 48.5293C65.8906 49.393 64.0912 49.8249 61.9798 49.8249C59.1487 49.8249 56.8215 49.1651 54.9981 47.8455C53.1986 46.5259 52.179 44.7265 51.939 42.4472H56.9414C57.2054 43.3589 57.7692 44.0787 58.6329 44.6065C59.5206 45.1584 60.5883 45.4343 61.8359 45.4343C63.2994 45.4343 64.487 44.9904 65.3987 44.1027C66.3104 43.239 66.7663 41.9194 66.7663 40.144V37.0489C66.1185 37.9846 65.2188 38.7644 64.0672 39.3882C62.9395 40.012 61.6439 40.3239 60.1804 40.3239C58.5009 40.3239 56.9654 39.892 55.5739 39.0283C54.1823 38.1646 53.0787 36.953 52.2629 35.3935C51.4712 33.81 51.0753 31.9986 51.0753 29.9592C51.0753 27.9439 51.4712 26.1564 52.2629 24.5969C53.0787 23.0374 54.1703 21.8378 55.5379 20.9981C56.9294 20.1583 58.477 19.7385 60.1804 19.7385ZM66.7663 30.0312C66.7663 28.8076 66.5264 27.7639 66.0465 26.9002C65.5667 26.0125 64.9189 25.3407 64.1032 24.8848C63.2874 24.405 62.4117 24.1651 61.476 24.1651C60.5403 24.1651 59.6766 24.393 58.8848 24.8488C58.0931 25.3047 57.4453 25.9765 56.9414 26.8642C56.4616 27.7279 56.2217 28.7596 56.2217 29.9592C56.2217 31.1588 56.4616 32.2145 56.9414 33.1262C57.4453 34.0139 58.0931 34.6977 58.8848 35.1775C59.7006 35.6574 60.5643 35.8973 61.476 35.8973C62.4117 35.8973 63.2874 35.6694 64.1032 35.2135C64.9189 34.7337 65.5667 34.0619 66.0465 33.1982C66.5264 32.3105 66.7663 31.2548 66.7663 30.0312ZM75.466 29.9592C75.466 27.9439 75.8618 26.1564 76.6536 24.5969C77.4693 23.0374 78.561 21.8378 79.9285 20.9981C81.3201 20.1583 82.8676 19.7385 84.5711 19.7385C86.0586 19.7385 87.3542 20.0384 88.4578 20.6382C89.5855 21.238 90.4852 21.9938 91.1569 22.9055V20.0624H96.2313V40H91.1569V37.0849C90.5092 38.0206 89.6094 38.8004 88.4578 39.4242C87.3302 40.024 86.0226 40.3239 84.5351 40.3239C82.8556 40.3239 81.3201 39.892 79.9285 39.0283C78.561 38.1646 77.4693 36.953 76.6536 35.3935C75.8618 33.81 75.466 31.9986 75.466 29.9592ZM91.1569 30.0312C91.1569 28.8076 90.917 27.7639 90.4372 26.9002C89.9573 26.0125 89.3095 25.3407 88.4938 24.8848C87.6781 24.405 86.8023 24.1651 85.8666 24.1651C84.9309 24.1651 84.0672 24.393 83.2755 24.8488C82.4837 25.3047 81.8359 25.9765 81.3321 26.8642C80.8522 27.7279 80.6123 28.7596 80.6123 29.9592C80.6123 31.1588 80.8522 32.2145 81.3321 33.1262C81.8359 34.0139 82.4837 34.6977 83.2755 35.1775C84.0912 35.6574 84.9549 35.8973 85.8666 35.8973C86.8023 35.8973 87.6781 35.6694 88.4938 35.2135C89.3095 34.7337 89.9573 34.0619 90.4372 33.1982C90.917 32.3105 91.1569 31.2548 91.1569 30.0312ZM112.381 19.7745C113.892 19.7745 115.236 20.1104 116.411 20.7821C117.587 21.4299 118.499 22.4016 119.146 23.6972C119.818 24.9688 120.154 26.5043 120.154 28.3037V40H115.116V28.9875C115.116 27.404 114.72 26.1924 113.928 25.3527C113.136 24.489 112.057 24.0571 110.689 24.0571C109.298 24.0571 108.194 24.489 107.378 25.3527C106.586 26.1924 106.191 27.404 106.191 28.9875V40H101.152V13.3685H106.191V22.5456C106.838 21.6819 107.702 21.0101 108.782 20.5302C109.861 20.0264 111.061 19.7745 112.381 19.7745Z"
          fill="#373737"
        />
        <path
          d="M72.9858 46.7902C72.9858 46.2234 73.0913 45.7258 73.3022 45.2973C73.5197 44.8689 73.813 44.5393 74.1821 44.3086C74.5513 44.0779 74.9632 43.9626 75.418 43.9626C75.8069 43.9626 76.1463 44.0417 76.4364 44.1999C76.733 44.3581 76.9604 44.5657 77.1186 44.8227V44.0417H78.8092V49.5586H77.1186V48.7775C76.9538 49.0346 76.7231 49.2422 76.4265 49.4004C76.1365 49.5586 75.797 49.6377 75.4081 49.6377C74.9599 49.6377 74.5513 49.5223 74.1821 49.2916C73.813 49.0544 73.5197 48.7215 73.3022 48.2931C73.0913 47.858 72.9858 47.3571 72.9858 46.7902ZM77.1186 46.8001C77.1186 46.3783 76.9999 46.0454 76.7626 45.8016C76.5319 45.5577 76.2485 45.4357 75.9124 45.4357C75.5762 45.4357 75.2895 45.5577 75.0522 45.8016C74.8215 46.0388 74.7061 46.3684 74.7061 46.7902C74.7061 47.2121 74.8215 47.5482 75.0522 47.7987C75.2895 48.0426 75.5762 48.1645 75.9124 48.1645C76.2485 48.1645 76.5319 48.0426 76.7626 47.7987C76.9999 47.5548 77.1186 47.222 77.1186 46.8001ZM79.6962 46.8001C79.6962 46.2267 79.8115 45.7258 80.0422 45.2973C80.2795 44.8689 80.6058 44.5393 81.0211 44.3086C81.4429 44.0779 81.9241 43.9626 82.4645 43.9626C83.1566 43.9626 83.7334 44.1438 84.1948 44.5064C84.6627 44.8689 84.9692 45.3797 85.1142 46.0388H83.3148C83.1632 45.617 82.8699 45.4061 82.4349 45.4061C82.1251 45.4061 81.8779 45.528 81.6934 45.7719C81.5088 46.0092 81.4165 46.3519 81.4165 46.8001C81.4165 47.2483 81.5088 47.5944 81.6934 47.8383C81.8779 48.0756 82.1251 48.1942 82.4349 48.1942C82.8699 48.1942 83.1632 47.9833 83.3148 47.5614H85.1142C84.9692 48.2074 84.6627 48.7149 84.1948 49.084C83.7268 49.4531 83.15 49.6377 82.4645 49.6377C81.9241 49.6377 81.4429 49.5223 81.0211 49.2916C80.6058 49.061 80.2795 48.7314 80.0422 48.303C79.8115 47.8745 79.6962 47.3736 79.6962 46.8001ZM85.6824 46.7902C85.6824 46.2234 85.7879 45.7258 85.9988 45.2973C86.2163 44.8689 86.5096 44.5393 86.8788 44.3086C87.2479 44.0779 87.6598 43.9626 88.1146 43.9626C88.5035 43.9626 88.843 44.0417 89.133 44.1999C89.4296 44.3581 89.657 44.5657 89.8152 44.8227V44.0417H91.5059V49.5586H89.8152V48.7775C89.6504 49.0346 89.4197 49.2422 89.1231 49.4004C88.8331 49.5586 88.4936 49.6377 88.1047 49.6377C87.6565 49.6377 87.2479 49.5223 86.8788 49.2916C86.5096 49.0544 86.2163 48.7215 85.9988 48.2931C85.7879 47.858 85.6824 47.3571 85.6824 46.7902ZM89.8152 46.8001C89.8152 46.3783 89.6965 46.0454 89.4593 45.8016C89.2286 45.5577 88.9451 45.4357 88.609 45.4357C88.2728 45.4357 87.9861 45.5577 87.7488 45.8016C87.5181 46.0388 87.4028 46.3684 87.4028 46.7902C87.4028 47.2121 87.5181 47.5482 87.7488 47.7987C87.9861 48.0426 88.2728 48.1645 88.609 48.1645C88.9451 48.1645 89.2286 48.0426 89.4593 47.7987C89.6965 47.5548 89.8152 47.222 89.8152 46.8001ZM92.3928 46.7902C92.3928 46.2234 92.4983 45.7258 92.7092 45.2973C92.9267 44.8689 93.22 44.5393 93.5891 44.3086C93.9583 44.0779 94.3702 43.9626 94.825 43.9626C95.1875 43.9626 95.5171 44.0384 95.8137 44.19C96.1169 44.3416 96.3542 44.5459 96.5256 44.803V42.2423H98.2162V49.5586H96.5256V48.7676C96.3674 49.0313 96.14 49.2422 95.8434 49.4004C95.5533 49.5586 95.2139 49.6377 94.825 49.6377C94.3702 49.6377 93.9583 49.5223 93.5891 49.2916C93.22 49.0544 92.9267 48.7215 92.7092 48.2931C92.4983 47.858 92.3928 47.3571 92.3928 46.7902ZM96.5256 46.8001C96.5256 46.3783 96.4069 46.0454 96.1696 45.8016C95.9389 45.5577 95.6555 45.4357 95.3194 45.4357C94.9832 45.4357 94.6965 45.5577 94.4592 45.8016C94.2285 46.0388 94.1131 46.3684 94.1131 46.7902C94.1131 47.2121 94.2285 47.5482 94.4592 47.7987C94.6965 48.0426 94.9832 48.1645 95.3194 48.1645C95.6555 48.1645 95.9389 48.0426 96.1696 47.7987C96.4069 47.5548 96.5256 47.222 96.5256 46.8001ZM104.64 46.7112C104.64 46.8693 104.63 47.0341 104.61 47.2055H100.784C100.81 47.5482 100.919 47.8119 101.11 47.9965C101.308 48.1744 101.549 48.2634 101.832 48.2634C102.254 48.2634 102.547 48.0854 102.712 47.7295H104.511C104.419 48.092 104.251 48.4183 104.007 48.7083C103.77 48.9983 103.47 49.2257 103.107 49.3905C102.745 49.5553 102.34 49.6377 101.891 49.6377C101.351 49.6377 100.87 49.5223 100.448 49.2916C100.026 49.061 99.6964 48.7314 99.4591 48.303C99.2218 47.8745 99.1032 47.3736 99.1032 46.8001C99.1032 46.2267 99.2186 45.7258 99.4492 45.2973C99.6865 44.8689 100.016 44.5393 100.438 44.3086C100.86 44.0779 101.344 43.9626 101.891 43.9626C102.425 43.9626 102.9 44.0746 103.315 44.2987C103.73 44.5228 104.053 44.8425 104.284 45.2578C104.521 45.673 104.64 46.1575 104.64 46.7112ZM102.91 46.2662C102.91 45.9762 102.811 45.7455 102.613 45.5742C102.415 45.4028 102.168 45.3171 101.872 45.3171C101.588 45.3171 101.348 45.3995 101.15 45.5643C100.959 45.729 100.84 45.963 100.794 46.2662H102.91ZM112.571 43.9824C113.257 43.9824 113.801 44.19 114.203 44.6052C114.611 45.0205 114.816 45.5972 114.816 46.3354V49.5586H113.135V46.5628C113.135 46.2069 113.039 45.9334 112.848 45.7422C112.664 45.5445 112.407 45.4456 112.077 45.4456C111.747 45.4456 111.487 45.5445 111.296 45.7422C111.111 45.9334 111.019 46.2069 111.019 46.5628V49.5586H109.338V46.5628C109.338 46.2069 109.243 45.9334 109.052 45.7422C108.867 45.5445 108.61 45.4456 108.28 45.4456C107.951 45.4456 107.69 45.5445 107.499 45.7422C107.315 45.9334 107.222 46.2069 107.222 46.5628V49.5586H105.532V44.0417H107.222V44.7338C107.394 44.5031 107.618 44.3218 107.895 44.19C108.172 44.0516 108.485 43.9824 108.834 43.9824C109.249 43.9824 109.618 44.0713 109.941 44.2493C110.271 44.4273 110.528 44.681 110.713 45.0106C110.904 44.7074 111.164 44.4602 111.494 44.2691C111.823 44.0779 112.182 43.9824 112.571 43.9824ZM121.634 44.0417L118.173 52.1786H116.354L117.62 49.3707L115.375 44.0417H117.264L118.539 47.4922L119.805 44.0417H121.634Z"
          fill="#A4A4A4"
        />
        <g filter="url(#filter1_d_830_1007)">
          <path
            d="M24.7605 7.18874C24.7605 6.52715 25.2972 5.98753 25.9578 6.02234C28.5376 6.15824 31.0784 6.73253 33.4705 7.72336C36.2319 8.86718 38.741 10.5437 40.8545 12.6572C42.968 14.7707 44.6445 17.2798 45.7884 20.0412C46.7792 22.4333 47.3535 24.9741 47.4894 27.5539C47.5242 28.2146 46.9846 28.7513 46.323 28.7513L25.9584 28.7513C25.2968 28.7513 24.7605 28.2149 24.7605 27.5534L24.7605 7.18874Z"
            fill="url(#paint2_radial_830_1007)"
            shape-rendering="crispEdges"
          />
        </g>
        <defs>
          <filter
            id="filter0_d_830_1007"
            x="0.204857"
            y="6.13845"
            width="50.315"
            height="50.314"
            filterUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feColorMatrix
              in="SourceAlpha"
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
              result="hardAlpha"
            />
            <feOffset dx="1.59722" dy="1.59722" />
            <feGaussianBlur stdDeviation="2.19618" />
            <feComposite in2="hardAlpha" operator="out" />
            <feColorMatrix
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.34 0"
            />
            <feBlend
              mode="normal"
              in2="BackgroundImageFix"
              result="effect1_dropShadow_830_1007"
            />
            <feBlend
              mode="normal"
              in="SourceGraphic"
              in2="effect1_dropShadow_830_1007"
              result="shape"
            />
          </filter>
          <filter
            id="filter1_d_830_1007"
            x="23.1635"
            y="5.22287"
            width="25.9249"
            height="25.9249"
            filterUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feColorMatrix
              in="SourceAlpha"
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
              result="hardAlpha"
            />
            <feOffset dy="0.798612" />
            <feGaussianBlur stdDeviation="0.798612" />
            <feComposite in2="hardAlpha" operator="out" />
            <feColorMatrix
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.35 0"
            />
            <feBlend
              mode="normal"
              in2="BackgroundImageFix"
              result="effect1_dropShadow_830_1007"
            />
            <feBlend
              mode="normal"
              in="SourceGraphic"
              in2="effect1_dropShadow_830_1007"
              result="shape"
            />
          </filter>
          <linearGradient
            id="paint0_linear_830_1007"
            x1="35.9427"
            y1="37.5359"
            x2="51.5299"
            y2="58.9256"
            gradientUnits="userSpaceOnUse"
          >
            <stop offset="0.0128067" />
            <stop offset="1" stop-opacity="0" />
          </linearGradient>
          <radialGradient
            id="paint1_radial_830_1007"
            cx="0"
            cy="0"
            r="1"
            gradientUnits="userSpaceOnUse"
            gradientTransform="translate(12.9281 17.1457) rotate(93.538) scale(31.3584)"
          >
            <stop stop-color="#7E7E7E" />
            <stop offset="1" />
          </radialGradient>
          <radialGradient
            id="paint2_radial_830_1007"
            cx="0"
            cy="0"
            r="1"
            gradientUnits="userSpaceOnUse"
            gradientTransform="translate(39.0995 17.8263) rotate(141.34) scale(16.0312)"
          >
            <stop offset="0.104167" stop-color="#B50606" />
            <stop offset="1" stop-color="#FF0000" stop-opacity="0.98" />
          </radialGradient>
        </defs>
      </svg>
      <h1 class="text-4xl mt-8 font-bold">
        به زودی <span class="text-[#ff3e00]">آکادمی آگاه...</span>
      </h1>
      <p class="text-[#777777] max-w-lg mt-7">
        ما سخت در تلاش هستیم تا بهترین و راحت ترین خدمات را به شما ارائه دهیم و
        همچنین به شما در کسب و کارتان کمک کنیم.
      </p>
      <div class="mt-7">
        <p>
          از صبر و شکیبایی شما متشکریم. با ما در ارتباط باشید!          
          <a href="mailto:info@agah.com" class="text-[#2d4095]">
            info@agah.com
          </a>
        </p>
      </div>

      <div class="col-10 mt-8">
        <p>وقتی آگاه راه اندازی شد با خبر شوید!</p>
        {#if !testing}
        <form in:fade={{delay : 600}} out:fly={{x:100}} method="post" on:submit|preventDefault="{postPhone}" class="search mt-2">
          {#if !active}
            <label
              in:fly={{ y: -10, duration: 500 }}
              out:fly={{ y: -10, duration: 500 }}
              for="search_movie">شماره همراه</label
            >
          {/if}

          <input
            on:blur={cancelInactive}
            on:focus={() => (active = true)}
            bind:value={inputValue}
            name="phonenumber"
            type="text"
            class={active ? "selected" : ""}
            required
            maxlength="11"
            min="11"
            id="numberid"
            pattern="09[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]"
          />
          {#if inputValue}
            <button
              in:fly={{ x: 0, duration: 500 }}
              out:fly={{ x: 20, duration: 500 }}>ثبت شماره</button
            >
          {/if}
        </form>
        {:else if error}
        <p in:fade={{delay : 600}} out:fly={{x:100}} class="text-2xl mt-9">{error}!</p>
        {:else}
        <p in:fade={{delay : 600}} out:fly={{x:100}} class="text-2xl mt-9">شماره‌ی شما با موفقیت ثبت شد.</p>
        {/if}
      </div>
    </div>
    <div class="d-none d-lg-block row lg:items-center lg:justify-center col-6">
      <img class="w-[500px]" src={vector} alt="" />
    </div>
  </div>
</div>

<style>
  #numberid:valid {
    color: rgb(255, 255, 255);
  }
  #numberid:invalid {
    color: rgb(239, 91, 91);
  }
  .bg-center {
    height: 700px;
    width: 1300px;
    /* background-color: #000; */
    border: 4px solid #fff;
    border-radius: 20px;
  }
  @media (max-width: 1300px) {
    .bg-center {
      height: 100%;
      width: 100%;
    }
  }
  .search {
    position: relative;
    /* width: 30%; */
    /* margin: 1rem; */
  }
  button {
    font-size: 0.9rem;
    padding: 0rem 3rem;
    background: rgb(96, 110, 201);
    color: #fff;
    font-weight: bold;
    border: none;
    position: absolute;
    bottom: 50%;
    right: 0;
    transform: translate(0, 50%);
    height: 100%;
    border-top-right-radius: 10px;
    border-bottom-right-radius: 10px;
    cursor: pointer;
  }
  input {
    width: 100%;
    border: none;
    font-size: 1rem;
    /* font-family: 'YekanBakh' , Poppins; */
    outline: none;
    color: rgb(255, 255, 255);
    padding: 0.5rem 0.1rem;
    transition: background 0.75s ease-out;
    font-weight: bold;
    background: rgb(63, 63, 63);
    border-radius: 10px;
    padding: 1rem;
    text-align: left;
  }
  label {
    position: absolute;
    font-size: 0.8rem;
    top: 50%;
    left: 0;
    transform: translate(0, -50%);
    pointer-events: none;
    color: #fff;
    padding: 0rem 1rem;
  }
  input.selected {
    background: rgb(50, 50, 50);
  }
</style>
